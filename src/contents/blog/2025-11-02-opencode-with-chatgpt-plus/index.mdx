---
title: OpenCode を ChatGPT Plus/Pro のサブスクリプション契約で使う方法
date: 2025-11-02
category: "プログラミング"
tags: ["OpenCode", "Codex", "ChatGPT", "OpenAI"]
amazonAssociate: true
amazonProductIds:
  - "実践Claude Code入門"
  - "Claude CodeによるAI駆動開発"
---

## 契機

2025 年 10 月から Claude Pro/Max プランに週間制限が追加された。
それ以前もデイリーで最初のリクエストした時間（分は切り捨てられる）から 5 時間でリセットされる利用量制限があったが、
追加で 1 週間単位での利用制限も追加された形だ。
このことは [Claude Sonnet 4.5 がリリースされたときに書いた記事](../2025-10-01-claude/) でも触れたが、
[設定画面](https://claude.ai/settings/usage) もしくは Claude Code 上で `/usage` コマンドを実行することで現在の使用料を確認できる。

<Img src="./images/claude-usage.png" width={600} />

この週間制限が結構厳しい。
現在契約しているのは Pro プランなので Max プランを契約すればいいという話ではあるが、
Pro プランと Max プランの価格差が 2025/11/02 現在だと $83 (12,777円) あるため、乗り換えに対してあまり前向きになれない。
Max プランを契約して枠を活用できるのはフリーランスで活動しているエンジニアくらいじゃないだろうか。
日中は会社で働いて業務終了後に 5 時間セッションを 2 回くらい回せたら御の字で、
土日の開発に使うくらいだと Max プランは持て余してしまう可能性が高い。

しかし、私の使い方だと木曜日にリセットされる周期になっているが、月曜日か火曜日には週間制限に到達してしまう。
つまり、Pro プランと Max プランの間の $40 くらいのプランがあると嬉しいのだが…。

少し前までは Cursor も契約していたが、Cursor の Pro プランでは $20 分くらいの高性能モデル利用量が毎月与えられるが、
これも Claude Sonnet 4.5 や GPT-5 Codex、Gemini 2.5 Pro といったモデルを使うと直ぐに使い切ってしまい、
月の半分くらいはそこそこのモデル + 賢い補完・編集機能のあるエディタ状態となってしまっていたので現在は契約していない。
最近、バージョンが 2.0 へ上がり、[UI 刷新とComposer という新しいモデルが発表された](https://cursor.com/ja/blog/2-0)ので改めて契約しようか悩んでいる。

## ChatGPT

そんなわけで、Claude Pro プランでは開発が止まることが増えてきたため
少し前から Claude より性能がいいと話題の GPT-5 Codex を使うために ChatGPT Pro プランを契約した。
Claude では [Claude Code](https://github.com/anthropics/claude-code)、
ChatGPT では [codex](https://github.com/openai/codex) がコーディングエージェントとなっている。

codex を使うのは今回が初めてだったが Claude Code と比較すると設定を細かく管理できないことに驚いた。
プロジェクトごとに設定ファイルを置くことはできず、`~/.codex/config.toml` に置いたファイルが常に有効になるようだ。
Profile 機能があるので疑似的にプロジェクト固有の設定をすることはできるが、
git で管理して配布することもできないし、`~/.codex/config.toml` にプロジェクトごとの設定を書くと
このファイル自体を git 管理して公開すると非公開にしたいプロジェクトに関する設定が漏れてしまう。
そのため、文字通り Profile としての活用しかできないだろう。

また、`sandbox_mode` や `approval_policy` も大雑把な制御しかできず、
Claude Code のようにコマンドのパターンごとにホワイトリスト、ブラックリストで制御することはできないようだ。
Claude Code を使っているときは `git commit` から PR の作成までまかせているのでその都度確認が入るのは煩わしい。

結局、`rm -rf ~/` をされるリスクを背負いつつ、以下の設定にしてしまっている。

```toml ~/.codex/config.toml
network_access = true
sandbox_mode = "danger-full-access"
approval_policy = "never"
```

これは同じことを思っている人が多いので codex に関連 Issue がいくつも作られている。

他にも codex はサーバーを起動したままハングアップしてしまうことが多い。
完了しないようなコマンドをバックグラウンドで実行しないため、いつまでもコマンドの終了を待ち続けてしまい、
気がついたらタスクが一切進んでいないという現象が頻繁に発生する。

そんなわけで codex に嫌気が指してしまったので [OpenCode](https://opencode.ai/) を ChatGPT Pro プランで使ったのでその設定をメモしておく。

## OpenCode

OpenCode は Claude Code, Codex, Gemini CLI といった LLM プロバイダが提供するターミナル上で動作するコーディングエージェントとは異なり、
あらゆるプロバイダ、モデル、エディタ上で動作するオープンソースのコーディングエージェントだ。

詳しくは[公式ドキュメント](https://opencode.ai/)を確認して欲しいが、
特徴としては LSP との連携がビルトイン機能となっているため [serena](https://github.com/oraios/serena) のような MCP サーバを入れなくても
LSP の機能を LLM が使えるようになっている。

### 設定

OpenCode を ChatGPT Plus で使うには設定ファイルを弄らないといけない。
その方法は、以下の Reddit から辿れる。

- [Use ChatGPT subscription with OpenCode? : r/ChatGPTCoding](https://www.reddit.com/r/ChatGPTCoding/comments/1mlls20/use_chatgpt_subscription_with_opencode/)

そこでは、[numman-ali/opencode-openai-codex-auth](https://github.com/numman-ali/opencode-openai-codex-auth) が紹介されており、
README.md に載っている以下の JSON を `~/.config/opencode/opencode.json` に保存する。

```json ~/.config/opencode/opencode.json
{
  "$schema": "https://opencode.ai/config.json",
  "plugin": [
    "opencode-openai-codex-auth"
  ],
  "provider": {
    "openai": {
      "options": {
        "reasoningEffort": "medium",
        "reasoningSummary": "auto",
        "textVerbosity": "medium",
        "include": [
          "reasoning.encrypted_content"
        ],
        "store": false
      },
      "models": {
        "gpt-5-codex-low": {
          "name": "GPT 5 Codex Low (OAuth)",
          "options": {
            "reasoningEffort": "low",
            "reasoningSummary": "auto",
            "textVerbosity": "medium",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-codex-medium": {
          "name": "GPT 5 Codex Medium (OAuth)",
          "options": {
            "reasoningEffort": "medium",
            "reasoningSummary": "auto",
            "textVerbosity": "medium",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-codex-high": {
          "name": "GPT 5 Codex High (OAuth)",
          "options": {
            "reasoningEffort": "high",
            "reasoningSummary": "detailed",
            "textVerbosity": "medium",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-minimal": {
          "name": "GPT 5 Minimal (OAuth)",
          "options": {
            "reasoningEffort": "minimal",
            "reasoningSummary": "auto",
            "textVerbosity": "low",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-low": {
          "name": "GPT 5 Low (OAuth)",
          "options": {
            "reasoningEffort": "low",
            "reasoningSummary": "auto",
            "textVerbosity": "low",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-medium": {
          "name": "GPT 5 Medium (OAuth)",
          "options": {
            "reasoningEffort": "medium",
            "reasoningSummary": "auto",
            "textVerbosity": "medium",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-high": {
          "name": "GPT 5 High (OAuth)",
          "options": {
            "reasoningEffort": "high",
            "reasoningSummary": "detailed",
            "textVerbosity": "high",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-mini": {
          "name": "GPT 5 Mini (OAuth)",
          "options": {
            "reasoningEffort": "low",
            "reasoningSummary": "auto",
            "textVerbosity": "low",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        },
        "gpt-5-nano": {
          "name": "GPT 5 Nano (OAuth)",
          "options": {
            "reasoningEffort": "minimal",
            "reasoningSummary": "auto",
            "textVerbosity": "low",
            "include": [
              "reasoning.encrypted_content"
            ],
            "store": false
          }
        }
      }
    }
  }
}
```

上記の設定を行なった後、`opencode auth login` を実行して `OpenAI` を選択する。

```shell
$ opencode auth login

┌  Add credential
│
◆  Select provider

│  Search:
│  ○ OpenCode Zen
│  ○ Anthropic
│  ○ GitHub Copilot
│  ● OpenAI
│  ○ Google
│  ○ OpenRouter
│  ○ Vercel AI Gateway
│  ...
│  ↑/↓ to select • Enter: confirm • Type: to search
└
```

そうすると `ChatGPT Plus/Pro (Codex Subscription)` という選択が現れる。

```shell
$ opencode auth login

┌  Add credential
│
◇  Select provider
│  OpenAI
│
◆  Login method
│  ● ChatGPT Plus/Pro (Codex Subscription)
│  ○ Manually enter API Key
└
```

選択するとブラウザが起動し、ChatGPT のログインを求められるのでそのまま進める。
最後まで問題なく完了すれば ChatGPT Plus プランで使える GPT-5 Codex を OpenCode で使えるようになる。

### 問題点

これでめでたしめでたし、となればよかったが、OpenCode で Codex を使うと利用枠が codex を使っているときの比ではない速度で消費されていく。
codex であれば数%程度の消費で完了するタスクで 20% 以上消費される現象が確認された。
codex の利用枠は Claude Code と違ってリクエスト数という単位が明確ではない量で利用枠が決まっているため、
OpenCode だとリクエスト数が多く使われてしまう問題の原因は特定できていない。
ググっても同様の現象を報告している人が見つからないので OpenCode を使っているときに依頼したタスク内容がたまたまリクエスト消費が多くなうようなものだった可能性もある。

しかし、**利用枠に対するアウトプットが少なくなる可能性が多いため OpenCode を ChatGPT Plus サブスクリプションで利用することはおすすめしない**。

原因や回避策がわかる方がいらっしゃったらコメントいただけるとありがたい。

## おわりに

ChatGPT Plus プランに契約したので codex を使ってみたが、世間で言われているほどの開発体験を得られたなかったため OpenCode で GPT-5 Codex を試してみたが、
利用枠が codex を使っているときよりも早く消費されてしまった。
結局 codex に戻ってきてしまったが、まだ契約して二日目なので Claude Code と codex で指示の仕方や任せていいタスクの粒度、進め方の違いを理解できておらず、活用できていないだけだと信じたい。

最近は [GPT-5 Codex の性能も劣化しているという噂](https://x.com/thsottiaux/status/1984465716888944712) があったので、
そこで見つかったイレギュラーパターンである不具合を踏んだ可能性は否定できない。

Claude と違って利用枠が ChatGPT と Codex で分かれているとは言え、ChatGPT Plus プランでの利用枠が少ないように感じてしまうが 1 ヶ月間はこのまま使い続けてみる。
Codex に対する評価が変わったら記事を書く予定。
みんなが言っているような Codex の優位性を感じたい。
